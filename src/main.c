#include <gb/gb.h>
#include <stdio.h>

/*

 Tile Source File.

 Info:
  Form                 : All tiles as one unit.
  Format               : Gameboy 4 color.
  Compression          : None.
  Counter              : None.
  Tile size            : 8 x 8
  Tiles                : 0 to 9

  Palette colors       : None.
  SGB Palette          : None.
  CGB Palette          : None.

  Convert to metatiles : No.

 This file was generated by GBTD v2.2

*/

unsigned char NumberTiles[] =
    {
        // 0
        0x18, 0x18, 0x24, 0x24, 0x24, 0x24, 0x2C, 0x2C,
        0x34, 0x34, 0x24, 0x24, 0x18, 0x18, 0x00, 0x00,
        // 1
        0x08, 0x08, 0x18, 0x18, 0x08, 0x08, 0x08, 0x08,
        0x08, 0x08, 0x08, 0x08, 0x1C, 0x1C, 0x00, 0x00,
        // 2
        0x18, 0x18, 0x24, 0x24, 0x04, 0x04, 0x08, 0x08,
        0x10, 0x10, 0x20, 0x20, 0x3C, 0x3C, 0x00, 0x00,
        // 3
        0x18, 0x18, 0x24, 0x24, 0x04, 0x04, 0x08, 0x08,
        0x04, 0x04, 0x24, 0x24, 0x18, 0x18, 0x00, 0x00,
        // 4
        0x08, 0x08, 0x18, 0x18, 0x28, 0x28, 0x28, 0x28,
        0x3C, 0x3C, 0x08, 0x08, 0x08, 0x08, 0x00, 0x00,
        // 5
        0x1C, 0x1C, 0x20, 0x20, 0x38, 0x38, 0x04, 0x04,
        0x04, 0x04, 0x24, 0x24, 0x18, 0x18, 0x00, 0x00,
        // 6
        0x18, 0x18, 0x24, 0x24, 0x20, 0x20, 0x38, 0x38,
        0x24, 0x24, 0x24, 0x24, 0x18, 0x18, 0x00, 0x00,
        // 7
        0x3C, 0x3C, 0x04, 0x04, 0x04, 0x04, 0x08, 0x08,
        0x08, 0x08, 0x10, 0x10, 0x10, 0x10, 0x00, 0x00,
        // 8
        0x18, 0x18, 0x24, 0x24, 0x24, 0x24, 0x18, 0x18,
        0x24, 0x24, 0x24, 0x24, 0x18, 0x18, 0x00, 0x00,
        // 9
        0x18, 0x18, 0x24, 0x24, 0x24, 0x24, 0x1C, 0x1C,
        0x04, 0x04, 0x24, 0x24, 0x18, 0x18, 0x00, 0x00,
        // blank
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

void main()
{
    // Load tileset into GB memory
    set_bkg_data(0, 11, NumberTiles);

    // Fill entire screen with 1st tile
    init_bkg(0);

    // Show background
    SHOW_BKG;
    DISPLAY_ON;

    uint8_t mButtons;
    uint8_t nTile = 0;
    int8_t nDriftX = -1;
    int8_t nDriftY = 0;

    while (1)
    {
        mButtons = joypad();

        if (mButtons & J_A)
        {
            nTile = (nTile + 1) % 11;
            init_bkg(nTile);
        }

        if (mButtons & J_B)
        {
            nTile = (nTile - 1) % 11;
            init_bkg(nTile);
        }

        if (mButtons & J_UP)
            nDriftY = -1;

        if (mButtons & J_DOWN)
            nDriftY = 1;

        if (mButtons & J_LEFT)
            nDriftX = -1;

        if (mButtons & J_RIGHT)
            nDriftX = 1;
        //    if (mButtons & J_START)
        //         printf("+ ");
        //    if (mButtons & J_SELECT)
        //         printf("- ");

        scroll_bkg(nDriftX, nDriftY);
        delay(100);
        // while (mButtons == joypad());
    }
}